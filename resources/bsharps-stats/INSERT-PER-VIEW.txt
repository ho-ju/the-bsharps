Simple Formula:

SELECT ROUND((SUM(TotalPoints) + SUM(FTM) - (SUM(FTA) - SUM(FTM)) + + SUM(3PT) - SUM(Fouls)) / (SUM(GmsPlayed)), 2)  as RES FROM tb_stats s, tb_players p WHERE s.pid = p.pid Group by p.pid


Average Formula

SELECT ROUND((SUM(TotalPoints) / SUM(GmsPlayed)), 2) as ttlAvgPts FROM tb_stats s, tb_players p WHERE s.pid = p.pid

SELECT pname, ROUND(((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid), 2) as TtlPts FROM tb_stats s, tb_players p WHERE s.pid = p.pid GROUP BY s.pid ORDER BY TtlPts DESC

SELECT pName, ROUND((((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid), 2) as TtlPts FROM tb_stats s, tb_players p WHERE s.pid = p.pid GROUP BY s.pid ORDER BY TtlPts DESC




SELECT pname, ROUND((SELECT ROUND(((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid), 2) as TtlPts FROM tb_stats s, tb_players p WHERE s.pid = p.pid GROUP BY s.pid)
-
(SELECT ROUND((((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid), 2) FROM tb_stats s, tb_players p WHERE s.pid = p.pid GROUP BY s.pid), 2) as TOTAL FROM tb_stats s, tb_players p WHERE s.pid = p.pid GROUP BY s.pid ORDER BY TOTAL DESC




SELECT pname, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid) as TtlPts, (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid) as ttlMFT FROM tb_stats s, tb_players p WHERE s.pid = p.pid GROUP BY s.pid

-------------------
CREATE VIEW view_player_rankings AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid) as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid) as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid) as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid) as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid) as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid) as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid) as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid GROUP BY s.pid;

CREATE VIEW view_player_rankings_finals AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.final = 'Y') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.final = 'Y') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.final = 'Y') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.final = 'Y') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.final = 'Y') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.final = 'Y') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.final = 'Y') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.final = 'Y' GROUP BY s.pid;

CREATE VIEW view_player_rankings_s08s_BHS AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '08s') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '08s') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '08s') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '08s') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '08s') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '08s') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '08s') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '08s' GROUP BY s.pid;

CREATE VIEW view_player_rankings_s09w_BHS AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '09w') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '09w') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '09w') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '09w') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '09w') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '09w') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '09w') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '09w' GROUP BY s.pid;

CREATE VIEW view_player_rankings_s10s_BHS AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10s') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10s') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10s') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10s') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10s') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10s') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10s') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10s' GROUP BY s.pid;


CREATE VIEW view_player_rankings_s10w_all AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10w') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10w') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10w') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10w') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10w') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10w') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10w') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10w' GROUP BY s.pid;


CREATE VIEW view_player_rankings_s10w_BHS AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10w' and s.comp = 'BHS') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10w' and s.comp = 'BHS') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10w' and s.comp = 'BHS') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10w' and s.comp = 'BHS') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10w' and s.comp = 'BHS') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10w' and s.comp = 'BHS') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10w' and s.comp = 'BHS') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10w' and s.comp = 'BHS' GROUP BY s.pid;


CREATE VIEW view_player_rankings_s10w_BHS2 AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10w' and s.comp = 'BHS2') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10w' and s.comp = 'BHS2') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10w' and s.comp = 'BHS2') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10w' and s.comp = 'BHS2') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10w' and s.comp = 'BHS2') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10w' and s.comp = 'BHS2') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10w' and s.comp = 'BHS2') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10w' and s.comp = 'BHS2' GROUP BY s.pid;


CREATE VIEW view_player_rankings_s11s_all AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11s') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11s') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11s') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11s') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11s') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11s') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11s') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11s' GROUP BY s.pid;


CREATE VIEW view_player_rankings_s11s_BHS AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11s' and s.comp = 'BHS') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11s' and s.comp = 'BHS') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11s' and s.comp = 'BHS') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11s' and s.comp = 'BHS') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11s' and s.comp = 'BHS') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11s' and s.comp = 'BHS') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11s' and s.comp = 'BHS') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11s' and s.comp = 'BHS' GROUP BY s.pid;


CREATE VIEW view_player_rankings_s11s_BHS2 AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11s' and s.comp = 'BHS2') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11s' and s.comp = 'BHS2') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11s' and s.comp = 'BHS2') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11s' and s.comp = 'BHS2') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11s' and s.comp = 'BHS2') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11s' and s.comp = 'BHS2') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11s' and s.comp = 'BHS2') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11s' and s.comp = 'BHS2' GROUP BY s.pid;

************* Season 2011 winter ************* 

CREATE VIEW view_player_rankings_s11w_BHS AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11w' and s.comp = 'BHS') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11w' and s.comp = 'BHS') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11w' and s.comp = 'BHS') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11w' and s.comp = 'BHS') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11w' and s.comp = 'BHS') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11w' and s.comp = 'BHS') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11w' and s.comp = 'BHS') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11w' and s.comp = 'BHS' GROUP BY s.pid;

CREATE VIEW view_player_rankings_s11w_BHS2 AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11w' and s.comp = 'BHS2') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11w' and s.comp = 'BHS2') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11w' and s.comp = 'BHS2') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11w' and s.comp = 'BHS2') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11w' and s.comp = 'BHS2') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11w' and s.comp = 'BHS2') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11w' and s.comp = 'BHS2') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11w' and s.comp = 'BHS2' GROUP BY s.pid;

CREATE VIEW view_player_rankings_s11w_all AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11w') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11w') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11w') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11w') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11w') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11w') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11w') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '11w' GROUP BY s.pid;


*********************************************
************* Season 2012 Summer ************* 

CREATE VIEW view_player_rankings_s12s_BHS AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12s' and s.comp = 'BHS') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12s' and s.comp = 'BHS') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12s' and s.comp = 'BHS') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12s' and s.comp = 'BHS') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12s' and s.comp = 'BHS') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12s' and s.comp = 'BHS') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12s' and s.comp = 'BHS') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12s' and s.comp = 'BHS' GROUP BY s.pid;

CREATE VIEW view_player_rankings_s12s_BHS2 AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12s' and s.comp = 'BHS2') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12s' and s.comp = 'BHS2') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12s' and s.comp = 'BHS2') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12s' and s.comp = 'BHS2') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12s' and s.comp = 'BHS2') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12s' and s.comp = 'BHS2') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12s' and s.comp = 'BHS2') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12s' and s.comp = 'BHS2' GROUP BY s.pid;

CREATE VIEW view_player_rankings_s12s_all AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12s') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12s') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12s') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12s') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12s') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12s') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12s') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12s' GROUP BY s.pid;


*********************************************

*********************************************
************* Season 2012 Winter ************* 

CREATE VIEW view_player_rankings_s12w_BHS AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12w' and s.comp = 'BHS') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12w' and s.comp = 'BHS') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12w' and s.comp = 'BHS') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12w' and s.comp = 'BHS') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12w' and s.comp = 'BHS') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12w' and s.comp = 'BHS') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12w' and s.comp = 'BHS') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12w' and s.comp = 'BHS' GROUP BY s.pid;

CREATE VIEW view_player_rankings_s12w_BHS2 AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12w' and s.comp = 'BHS2') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12w' and s.comp = 'BHS2') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12w' and s.comp = 'BHS2') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12w' and s.comp = 'BHS2') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12w' and s.comp = 'BHS2') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12w' and s.comp = 'BHS2') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12w' and s.comp = 'BHS2') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12w' and s.comp = 'BHS2' GROUP BY s.pid;

CREATE VIEW view_player_rankings_s12w_all AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12w') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12w') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12w') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12w') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12w') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12w') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12w') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '12w' GROUP BY s.pid;


*********************************************


*********************************************
************* Season 2013 Summer ************* 

CREATE VIEW view_player_rankings_s13s_BHS AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13s' and s.comp = 'BHS') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13s' and s.comp = 'BHS') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13s' and s.comp = 'BHS') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13s' and s.comp = 'BHS') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13s' and s.comp = 'BHS') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13s' and s.comp = 'BHS') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13s' and s.comp = 'BHS') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13s' and s.comp = 'BHS' GROUP BY s.pid;

CREATE VIEW view_player_rankings_s13s_BHS2 AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13s' and s.comp = 'BHS2') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13s' and s.comp = 'BHS2') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13s' and s.comp = 'BHS2') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13s' and s.comp = 'BHS2') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13s' and s.comp = 'BHS2') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13s' and s.comp = 'BHS2') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13s' and s.comp = 'BHS2') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13s' and s.comp = 'BHS2' GROUP BY s.pid;

CREATE VIEW view_player_rankings_s13s_all AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13s') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13s') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13s') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13s') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13s') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13s') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13s') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13s' GROUP BY s.pid;


*********************************************

*********************************************
************* Season 2013 WINTER ************* 

CREATE VIEW view_player_rankings_s13w_BHS AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13w' and s.comp = 'BHS') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13w' and s.comp = 'BHS') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13w' and s.comp = 'BHS') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13w' and s.comp = 'BHS') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13w' and s.comp = 'BHS') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13w' and s.comp = 'BHS') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13w' and s.comp = 'BHS') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13w' and s.comp = 'BHS' GROUP BY s.pid;

CREATE VIEW view_player_rankings_s13w_all AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13w') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13w') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13w') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13w') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13w') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13w') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13w') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '13w' GROUP BY s.pid;


*********************************************



*********************************************
************* Season 2014 SUMMER ************* 

CREATE VIEW view_player_rankings_s14s_BHS AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14s' and s.comp = 'BHS') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14s' and s.comp = 'BHS') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14s' and s.comp = 'BHS') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14s' and s.comp = 'BHS') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14s' and s.comp = 'BHS') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14s' and s.comp = 'BHS') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14s' and s.comp = 'BHS') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14s' and s.comp = 'BHS' GROUP BY s.pid;


CREATE VIEW view_player_rankings_s14s_all AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14s') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14s') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14s') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14s') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14s') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14s') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14s') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14s' GROUP BY s.pid;


*********************************************
************* Season 2014 Winter ************* 

CREATE VIEW view_player_rankings_s14w_BHS AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14w' and s.comp = 'BHS') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14w' and s.comp = 'BHS') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14w' and s.comp = 'BHS') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14w' and s.comp = 'BHS') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14w' and s.comp = 'BHS') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14w' and s.comp = 'BHS') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14w' and s.comp = 'BHS') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14w' and s.comp = 'BHS' GROUP BY s.pid;

CREATE VIEW view_player_rankings_s14w_all AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14w') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14w') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14w') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14w') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14w') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14w') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14w') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '14w' GROUP BY s.pid;


*********************************************


*********************************************
************* Season 2015 Summer ************* 

CREATE VIEW view_player_rankings_s15s_BHS AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15s' and s.comp = 'BHS') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15s' and s.comp = 'BHS') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15s' and s.comp = 'BHS') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15s' and s.comp = 'BHS') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15s' and s.comp = 'BHS') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15s' and s.comp = 'BHS') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15s' and s.comp = 'BHS') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15s' and s.comp = 'BHS' GROUP BY s.pid;

CREATE VIEW view_player_rankings_s15s_all AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15s') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15s') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15s') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15s') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15s') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15s') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15s') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15s' GROUP BY s.pid;


*********************************************

*********************************************
************* Winter 2015 Summer ************* 

CREATE VIEW view_player_rankings_s15w_BHS AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15w' and s.comp = 'BHS') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15w' and s.comp = 'BHS') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15w' and s.comp = 'BHS') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15w' and s.comp = 'BHS') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15w' and s.comp = 'BHS') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15w' and s.comp = 'BHS') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15w' and s.comp = 'BHS') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15w' and s.comp = 'BHS' GROUP BY s.pid;

CREATE VIEW view_player_rankings_s15w_all AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15w') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15w') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15w') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15w') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15w') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15w') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15w') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '15w' GROUP BY s.pid;


*********************************************
************* 2016 Summer ************* 

CREATE VIEW view_player_rankings_s16s_BHS AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16s' and s.comp = 'BHS') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16s' and s.comp = 'BHS') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16s' and s.comp = 'BHS') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16s' and s.comp = 'BHS') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16s' and s.comp = 'BHS') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16s' and s.comp = 'BHS') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16s' and s.comp = 'BHS') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16s' and s.comp = 'BHS' GROUP BY s.pid;

CREATE VIEW view_player_rankings_s16s_all AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16s') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16s') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16s') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16s') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16s') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16s') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16s') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16s' GROUP BY s.pid;



*********************************************
************* 2016 Winter ************* 

CREATE VIEW view_player_rankings_s16w_BHS AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16w' and s.comp = 'BHS') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16w' and s.comp = 'BHS') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16w' and s.comp = 'BHS') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16w' and s.comp = 'BHS') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16w' and s.comp = 'BHS') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16w' and s.comp = 'BHS') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16w' and s.comp = 'BHS') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16w' and s.comp = 'BHS' GROUP BY s.pid;

CREATE VIEW view_player_rankings_s16w_all AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16w') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16w') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16w') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16w') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16w') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16w') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16w') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '16w' GROUP BY s.pid;


*********************************************

*********************************************
************* 2017 Summer ************* 

CREATE VIEW view_player_rankings_s17s_BHS AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17s' and s.comp = 'BHS') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17s' and s.comp = 'BHS') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17s' and s.comp = 'BHS') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17s' and s.comp = 'BHS') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17s' and s.comp = 'BHS') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17s' and s.comp = 'BHS') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17s' and s.comp = 'BHS') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17s' and s.comp = 'BHS' GROUP BY s.pid;

CREATE VIEW view_player_rankings_s17s_all AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17s') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17s') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17s') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17s') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17s') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17s') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17s') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17s' GROUP BY s.pid;


*********************************************
************* 2017 Winter ************* 

CREATE VIEW view_player_rankings_s17w_BHS AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17w' and s.comp = 'BHS') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17w' and s.comp = 'BHS') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17w' and s.comp = 'BHS') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17w' and s.comp = 'BHS') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17w' and s.comp = 'BHS') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17w' and s.comp = 'BHS') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17w' and s.comp = 'BHS') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17w' and s.comp = 'BHS' GROUP BY s.pid;

CREATE VIEW view_player_rankings_s17w_all AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17w') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17w') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17w') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17w') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17w') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17w') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17w') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '17w' GROUP BY s.pid;

*********************************************
************* 2018 Summer ************* 

CREATE VIEW view_player_rankings_s18s_BHS AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '18s' and s.comp = 'BHS') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '18s' and s.comp = 'BHS') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '18s' and s.comp = 'BHS') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '18s' and s.comp = 'BHS') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '18s' and s.comp = 'BHS') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '18s' and s.comp = 'BHS') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '18s' and s.comp = 'BHS') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '18s' and s.comp = 'BHS' GROUP BY s.pid;

CREATE VIEW view_player_rankings_s18s_all AS
SELECT p.image, pname, p.PID, SUM(GmsPlayed) as gmsPlayed, ((SUM(TotalPoints) / SUM(GmsPlayed))) - (SELECT ((SUM(TotalPoints) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '18s') as TtlPts, ((SUM(3pt) / SUM(GmsPlayed))) - (SELECT ((SUM(3pt) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '18s') as Ttl3pts, ((SUM(FTM) / SUM(GmsPlayed))) - (SELECT ((SUM(FTM) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '18s') as TtlFTM, ((SUM(FTA) / SUM(GmsPlayed))) - (SELECT ((SUM(FTA) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '18s') as TtlFTA,(((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) - (SELECT (((SUM(FTA)-SUM(FTM)) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '18s') as ttlMFT, ((SUM(FTM) / SUM(FTA))) - (SELECT ((SUM(FTM) / SUM(FTA))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '18s') as FTP, ((SUM(Fouls) / SUM(GmsPlayed))) - (SELECT ((SUM(Fouls) / SUM(GmsPlayed))) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '18s') as TtlFouls FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '18s' GROUP BY s.pid;


*********************************************


select pname, ROUND(((TtlPts + Ttl3pts + TtlFTM + TtlFTA + TtlFouls)) - (TtlMFT * 2),2) as TOTAL from view_player_rankings order by total desc;




select image, pname, ROUND(TtlPts,2) as TtlPts, ROUND(Ttl3pts,2) as Ttl3pts,ROUND(TtlFTM,2) as TtlFTM, ROUND(TtlFTA,2) as TtlFTA, ROUND(ttlMFT,2) as ttlMFT, ROUND(TtlFouls,2) as TtlFouls, ROUND(((TtlPts + Ttl3pts + TtlFTM + TtlFTA + TtlFouls)) - (TtlMFT * 2),2) as TOTAL from view_player_rankings order by total desc;






SELECT p.image, p.PName, ROUND((SUM(FTM) / SUM(FTA)), 2) AS FTPercentage, SUM(GmsPlayed) as GmsPlayed FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10s' GROUP BY s.pid ORDER BY FTPercentage DESC, GmsPlayed ASC



SELECT p.image, p.PName, (ROUND((SUM(FTM) / SUM(FTA)), 2)) - ( SELECT ROUND((SUM(FTM) / SUM(FTA)), 2)  AS FTPercentage FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10s' GROUP BY s.pid




CREATE VIEW view_player_averages_S10s AS


SELECT p.image, pname, SELECT p.image, p.PName, ROUND(((SUM(TotalPoints) / SUM(GmsPlayed))), 1) FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10s') as avgPts FROM tb_stats s, tb_players p WHERE s.pid = p.pid and s.seasonID = '10s' GROUP BY s.pid

